<!DOCTYPE html>
<meta charset="utf-8">
<title>Video-Test</title>
<script src="../lib/shims.js"></script>
<link rel="stylesheet" href="../lib/qunit.css">
<script src="../lib/qunit.js"></script>

<div id="qunit"></div>

<script>
  QUnit.config.autostart = false;
  QUnit.config.reorder = false;
  var require = { baseUrl: '../' };
</script>
<script src="../requireconfig.js"></script>
<script src="../lib/require.js"></script>

<script>
require(['renderVideo', 'q'], function(renderVideo, Q){

  test('Modul-API', function(){
    ok(typeof renderVideo === 'function', 'Modul-API ist eine Funktion');
    equal(renderVideo.length, 1, 'Modul-API akzeptiert ein Argument');
  });

  asyncTest('Rendern eines Videos', function(){
    var result;
    var videoPromise = renderVideo('assets/test.webm');
    ok(typeof videoPromise.then === 'function',
      'Modul-API gibt ein Promise zurück');
    videoPromise.then(function successCallback(video){
      result = video;
    });
    videoPromise.finally(function(){
      equal(videoPromise.isFulfilled(), true,
        'Promise wurde aufgelöst');
      equal(typeof result, 'object',
        'Promise wird mit Objekt aufgelöst');
      equal(result.toString(), '[object HTMLVideoElement]',
        'Promise wird mit Video-Element aufgelöst');
      ok(result.readyState >= 2, 'Video-Element ist abspielbereit');
      start();
    });
  });

  QUnit.start();

});
</script>